version: 2

macros:
  - name: ga4_param
    description: Extract a parameter with the specified key as column.
    arguments:
      - name: record
        type: string
        description: The name of the record we have to extract the parameter from.

      - name: key
        type: string
        description: The name of the parameter we want to extract.

      - name: key_type
        type: string
        description: The type of the parameter we want to extract.
          Either string, int, float

      - name: alias
        type: string
        description: The name we want to give to the resulting column.

  - name: ga4_events_source
    description: Creates a cte that unnests and renames a lot of fields
      from the raw ga4 sharded events tables. The purpose of this macro
      is to serve as the "source" layer for ga4 events. The fields offered by
      the cte are a subset of the ones documented
      [here](https://support.google.com/analytics/answer/7029846).


      We don't create a source model because otherwise we would be querying all
      tables all the time. With this macro we can heavily restrict the data we
      query by specifying a start and end date.
    arguments:
      - name: start_date
        type: string (Format YYYY-MM-DD)
        description: The start date of the data we want to query.

      - name: event
        type: string
        description: The name of the event we want to query. This parameter is optional.
